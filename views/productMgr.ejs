<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/management/plugins/font-awesome/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="/management/css/adminlte.min.css">
  <!-- iCheck -->
  <link rel="stylesheet" href="/management/plugins/iCheck/flat/blue.css">
  <!-- Morris chart -->
  <link rel="stylesheet" href="/management/plugins/morris/morris.css">
  <!-- jvectormap -->
  <link rel="stylesheet" href="/management/plugins/jvectormap/jquery-jvectormap-1.2.2.css">
  <!-- Date Picker -->
  <link rel="stylesheet" href="/management/plugins/datepicker/datepicker3.css">
  <!-- Daterange picker -->
  <link rel="stylesheet" href="/management/plugins/daterangepicker/daterangepicker-bs3.css">
  <!-- bootstrap wysihtml5 - text editor -->
  <link rel="stylesheet" href="/management/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css">
  <link rel="stylesheet" href="/management/css/common.css">
  <!-- Google Font: Source Sans Pro -->
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
</head>

<body class="hold-transition sidebar-mini">
  <div class="wrapper">

    <!-- Navbar -->
    <nav class="main-header navbar navbar-expand bg-white navbar-light border-bottom">
      <!-- Left navbar links -->
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" data-widget="pushmenu" href="#"><i class="fa fa-bars"></i></a>
        </li>
      </ul>

    </nav>
    <!-- /.navbar -->
    <div class="tlinks">Collect from <a href="#">手机网站模板</a></div>
    <!-- Main Sidebar Container -->
    <aside class="main-sidebar sidebar-dark-primary elevation-4">
      <!-- Brand Logo -->
      <a href="/management" class="brand-link">
        <img src="/management/img/AdminLTELogo.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3"
          style="opacity: .8">
        <span class="brand-text font-weight-light">后台管理</span>
      </a>

      <!-- Sidebar -->
      <div class="sidebar">
        <!-- Sidebar user panel (optional) -->
        <div class="user-panel mt-3 pb-3 mb-3 d-flex">
          <div class="image">
            <img src="/management/img/user2-160x160.jpg" class="img-circle elevation-2" alt="User Image">
          </div>
          <div class="info">
            <a href="#" class="d-block">Admin</a>
          </div>
        </div>

        <!-- Sidebar Menu -->
        <nav class="mt-2">
          <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
            <!-- Add icons to the links using the .nav-icon class
               with font-awesome or any other icon font library -->
            <li class="nav-item has-treeview menu-open">
              <a href="#" class="nav-link">
                <i class="nav-icon fa fa-tree"></i>
                <p>
                  商品管理
                  <i class="fa fa-angle-left right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="/management/categoryMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>创建分类</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/partsMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>创建配置</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link active">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>创建商品</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/partsMgrM" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>配置管理</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/productMgrM" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>商品管理</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/categoryMgrM" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>分类管理</p>
                  </a>
                </li>
              </ul>
            </li>
            <li class="nav-item has-treeview">
              <a href="#" class="nav-link">
                <i class="nav-icon fa fa-edit"></i>
                <p>
                  用户管理
                  <i class="fa fa-angle-left right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="/management/userMgrM" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>用户管理</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>用户询价</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>用户建议</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>用户培训</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/roleMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>规则管理</p>
                  </a>
                </li>
              </ul>
            </li>
            <li class="nav-item has-treeview">
              <a href="#" class="nav-link">
                <i class="nav-icon fa fa-table"></i>
                <p>
                  订单管理
                  <i class="fa fa-angle-left right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="/management/orderMgrM" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>订单列表</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>修改订单</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/customServiceMgrM" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>售后管理</p>
                  </a>
                </li>
              </ul>
            </li>
            <li class="nav-item has-treeview">
              <a href="#" class="nav-link">
                <i class="nav-icon fa fa-tree"></i>
                <p>
                  案例管理
                  <i class="fa fa-angle-left right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="/management/caseMgrM" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>案例列表</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>案例修改</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/caseMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>创建案例</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/casePartsMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>创建分类</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/casePartsMgrM" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>分类管理</p>
                  </a>
                </li>
              </ul>
            </li>
            <li class="nav-item has-treeview">
              <a href="#" class="nav-link">
                <i class="nav-icon fa fa-edit"></i>
                <p>
                  视频管理
                  <i class="fa fa-angle-left right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="/management/videoMgrM" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>视频列表</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>视频修改</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/videoMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>创建视频</p>
                  </a>
                </li>
              </ul>
            </li>

            <li class="nav-item has-treeview">
              <a href="#" class="nav-link">
                <i class="nav-icon fa fa-table"></i>
                <p>
                  集成伙伴
                  <i class="fa fa-angle-left right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="/management/integratorMgrM" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>集成伙伴列表</p>
                  </a>
                </li>
                <!-- <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>修改集成伙伴</p>
                  </a>
                </li> -->
                <li class="nav-item">
                  <a href="/management/integratorMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>创建集成伙伴</p>
                  </a>
                </li>
              </ul>
            </li>

            <li class="nav-item has-treeview">
              <a href="#" class="nav-link">
                <i class="nav-icon fa fa-table"></i>
                <p>
                  页面管理
                  <i class="fa fa-angle-left right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="/management/homeMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>首页管理</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/supportMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>支持管理</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/whoMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>我们是谁</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/contractMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>联系我们</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/guideMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>购物指南</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="/management/softwareMgr" class="nav-link">
                    <i class="fa fa-circle-o nav-icon"></i>
                    <p>销售工具</p>
                  </a>
                </li>
              </ul>
            </li>
            <!-- <li class="nav-header">LABELS</li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="nav-icon fa fa-circle-o text-danger"></i>
              <p class="text">Important</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="nav-icon fa fa-circle-o text-warning"></i>
              <p>Warning</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="nav-icon fa fa-circle-o text-info"></i>
              <p>Informational</p>
            </a>
          </li> -->
          </ul>
        </nav>
        <!-- /.sidebar-menu -->
      </div>
      <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
      <!-- Content Header (Page header) -->
      <div class="content-header">
        <div class="container-fluid">
          <div class="row mb-2">
            <div class="col-sm-6">
              <h1 class="m-0 text-dark">商品管理</h1>
            </div><!-- /.col -->
            <div class="col-sm-6">
              <ol class="breadcrumb float-sm-right">
                <!-- <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active">Dashboard v2</li> -->
              </ol>
            </div><!-- /.col -->
          </div><!-- /.row -->
        </div><!-- /.container-fluid -->
      </div>
      <!-- /.content-header -->

      <!-- Main content -->
      <section class="content">
        <div class="container-fluid">
          <div class="col-md-12">
            <!-- general form elements -->
            <div class="card card-primary">
              <div class="card-header">
                <h3 class="card-title">
                  <%=title %>
                </h3>
              </div>
              <!-- /.card-header -->
              <!-- form start -->
              <form role="form">
                <div class="card-body">
                  <input class="pid" type="text" hidden value="<%=product.pid || '' %>">
                  <div class="form-group">
                    <label for="produtType">商品型号</label>
                    <input value="<%=product.produtType %>" class="form-control produtType" type="text" placeholder="例如：G5102">
                  </div>
                  <div class="form-group">
                    <label for="title">商品名称</label>
                    <input value="<%=product.title %>" class="form-control title" type="text" placeholder="例如：托辊式中驱皮带机G5102">
                  </div>
                  <div class="form-group">
                    <label for="productSEO">搜索关键词（SEO）</label>
                    <input value="<%=product.productSEO %>" class="form-control productSEO" type="text" placeholder="例如：本产品XXXXXXXXX">
                  </div>
                  <div class="form-group">
                    <label for="productDesc">商品描述</label>
                    <input value="<%=product.productDesc %>" class="form-control productDesc" type="text" placeholder="例如：本产品XXXXXXXXX">
                  </div>
                  <!-- <div class="form-group">
                    <label for="identifier">商品编号</label>
                    <input value="<%=product.identifier %>" class="form-control identifier" type="text" placeholder="例如：G5102_517*2280">
                  </div> -->

                  <!-- <div class="form-group">
                    <label for="size">商品大小</label>
                    <input value="<%=product.size %>" class="form-control size" type="text" placeholder="例如：宽度B/B X 总长度L（mm)"> -->
                  <!-- </div>
                  <div class="form-group">
                    <label for="weight">商品重量</label>
                    <input value="<%=product.weight %>" class="form-control weight" type="text" placeholder="例如：500kg">
                  </div>
                  <div class="form-group">
                    <label for="weight">商品促销文本</label>
                    <input value="<%=product.promotion ? product.promotion.promotionText : '' %>" class="form-control promotion"
                      type="text" placeholder="例如：「赠送价值2999元的高品质手推车1辆">
                  </div>
                  <div class="form-group">
                    <label for="onSale">是否是促销商品</label>
                    <select class="form-control onSale">
                      <%if(product.onSale != undefined && product.onSale == 0){ %>
                      <option>否</option>
                      <option>是</option>
                      <%}else{ %>
                      <option>是</option>
                      <option>否</option>
                      <%} %>
                    </select>
                  </div> -->

                  <div class="form-group categoryDom">
                    <label for="onSale">选择分类</label>
                    <select class="form-control category">
                      <%if(product.store && product.store.storeName && product.store.storeName != ''){ %>
                      <option data-target="<%=product.store.storeId %>">
                        <%=product.store.storeName %>
                      </option>
                      <%}else{ %>
                      <option>请选择</option>
                      <%} %>
                      <%if(stores && stores.length > 0){ stores.forEach(function(child){ %>
                      <%if(product.store && product.store.storeName && product.store.storeName != ''){ %>
                      <%if(child.storeId != product.store.storeId){ %>
                      <option data-target="<%=child.storeId %>">
                        <%=child.storeName %>
                      </option>
                      <%} %>
                      <%}else{ %>
                      <option data-target="<%=child.storeId %>">
                        <%=child.storeName %>
                      </option>
                      <%} %>
                      <%})} %>
                      <!-- <option data-target="1">箱式输送机</option> -->
                      <!-- <option data-target="2">托盘输送机</option> -->
                    </select>
                  </div>

                  <%if(product.parts && product.parts.length > 0){ product.parts.forEach(function(child, index){ %>
                  <div class="form-group">
                    <label for="onSale">选择配置 </label>
                    <%if(index == 0){%>
                    <label class="addPartsDom addBlue" for="onSale"> +</label>
                    <%} %>
                    <div style="display:flex" class="partsDom">
                      <input class="form-control search" type="text" placeholder="例如：输入搜索关键词">
                      <select class="form-control parts">
                        <option data-target="<%=child.partsId %>">
                          <%=child.name %> ---
                          <%=child.pName %>
                        </option>
                        <%if(parts && parts.length > 0){ parts.forEach(function(cld){ %>
                        <%if(cld.partsId != child.partsId){ %>
                        <option data-target="<%=cld.partsId %>">
                          <%=cld.name %> ---
                          <%=cld.pName %>
                        </option>
                        <%} %>
                        <%})} %>
                        <!-- <option data-target="psId_13984500430035">承载(kg/m)</option> -->
                      </select>
                      <button type="button" class="btn btn-danger deleteParts">X</button>
                    </div>
                  </div>
                  <%})}else{ %>
                  <div class="form-group ">
                    <label for="onSale">选择配置 </label>
                    <label class="addPartsDom addBlue" for="onSale"> +</label>
                    <div style="display:flex" class="partsDom">
                      <input class="form-control search" type="text" placeholder="例如：输入搜索关键词">
                      <select class="form-control parts ">
                        <option>请选择</option>
                        <%if(parts && parts.length > 0){ parts.forEach(function(child){ %>
                        <option data-target="<%=child.partsId %>">
                          <%=child.name %> ---
                          <%=child.pName %>
                        </option>
                        <%})} %>
                        <!-- <option data-target="psId_13984500430035">承载(kg/m)</option> -->
                      </select>
                      <button type="button" class="btn btn-danger deleteParts">X</button>
                    </div>
                  </div>
                  <%} %>


                  <%if(product.property && product.property.length > 0){ product.property.forEach(function(child, index){%>
                  <div class="form-group">
                    <label for="onSale">商品规格 </label>
                    <%if(index == 0){ %>
                    <label class="addPropertyDom addBlue" for="onSale"> +</label>
                    <%} %>
                    <div class="row propertyDom">
                      <div class="col-3">
                        <input value="<%=child.name %>" type="text" class="form-control" placeholder="例如：517*2280">
                      </div>
                      <div class="col-1">
                        <input value="<%=child.amount %>" type="text" class="form-control" placeholder="金额">
                      </div>
                      <div class="col-1">
                        <input value="<%=child.qty %>" type="text" class="form-control" placeholder="库存">
                      </div>
                      <div class="col-1">
                        <input value="<%=child.weight %>" type="text" class="form-control" placeholder="重量">
                      </div>
                      <div class="col-4">
                        <input value="<%=child.promotionText %>" type="text" class="form-control" placeholder="例如：「赠送价值2999元的高品质手推车1辆">
                      </div>
                      <div class="col-1">
                        <button type="button" class="btn btn-danger deletePropertyDom">X</button>
                      </div>
                    </div>
                  </div>
                  <%})}else{ %>
                  <div class="form-group ">
                    <label for="onSale">商品规格 </label>
                    <label class="addPropertyDom addBlue" for="onSale"> +</label>
                    <div class="row propertyDom">
                      <div class="col-3">
                        <input type="text" class="form-control" placeholder="例如：517*2280">
                      </div>
                      <div class="col-1">
                        <input type="text" class="form-control" placeholder="金额">
                      </div>
                      <div class="col-1">
                        <input type="text" class="form-control" placeholder="库存">
                      </div>
                      <div class="col-1">
                        <input type="text" class="form-control" placeholder="重量">
                      </div>
                      <div class="col-4">
                        <input type="text" class="form-control" placeholder="例如：「赠送价值2999元的高品质手推车1辆">
                      </div>
                      <div class="col-1">
                        <button type="button" class="btn btn-danger deletePropertyDom">X</button>
                      </div>
                    </div>
                  </div>
                  <%} %>

                  
                  <div class="form-group">
                      <label for="selectionAddress">商品选型文件(pdf)</label>
                      <div class="input-group" data-provides="fileinput">
                        <div class="custom-file">
                          <input type="file" class="custom-file-input selectionPdf" id="exampleInputFile" accept="pdf">
                          <label class="custom-file-label" for="exampleInputFile">选择商品选型文件</label>
                        </div>
                        <div class="input-group-append">
                          <!-- <span class="input-group-text" id="">Upload</span> -->
                        </div>
  
                      </div>
                    </div>
  
                    <div class="form-group">
                      <label for="applicationAddress">商品应用文件(pdf)</label>
                      <div class="input-group" data-provides="fileinput">
                        <div class="custom-file">
                          <input type="file" class="custom-file-input applicationPdf" id="exampleInputFile" accept="pdf">
                          <label class="custom-file-label" for="exampleInputFile">选择商品选型文件</label>
                        </div>
                        <div class="input-group-append">
                          <!-- <span class="input-group-text" id="">Upload</span> -->
                        </div>
  
                      </div>
                    </div>
  
                    <div class="form-group">
                      <label for="installAddress">商品安装维护文件(pdf)</label>
                      <div class="input-group" data-provides="fileinput">
                        <div class="custom-file">
                          <input type="file" class="custom-file-input installPdf" id="exampleInputFile" accept="pdf">
                          <label class="custom-file-label" for="exampleInputFile">选择商品选型文件</label>
                        </div>
                        <div class="input-group-append">
                          <!-- <span class="input-group-text" id="">Upload</span> -->
                        </div>
  
                      </div>
                    </div>

                  <div class="mb-3">
                    <label for="description">商品描述</label>
                    <!-- <%if(product.description){ %>
                    <%-product.description %>
                    <%} %> -->
                    <textarea id="description" name="description" style="width: 100%; display: none;"></textarea>
                  </div>

                  <div class="mb-3">
                    <label for="structure">商品结构</label>
                    <!-- <%if(product.structure){ %>
                    <%-product.structure %>
                    <%} %> -->
                    <textarea id="structure" name="structure" style="width: 100%; display: none;"></textarea>
                  </div>


                  <div class="mb-3">
                    <label for="configure">配置说明</label>
                    <!-- <%if(product.configure){ %>
                    <%-product.configure %>
                    <%} %> -->
                    <textarea id="configure" name="configure" style="width: 100%; display: none;"></textarea>
                  </div>


                  <div class="mb-3">
                    <label for="help">常见问题帮助</label>
                    <!-- <%if(product.help){ %>
                    <%-product.help %>
                    <%} %> -->
                    <textarea id="help" name="help" style="width: 100%; display: none;"></textarea>
                  </div>


                  <div class="form-group">
                    <label for="exampleInputFile">商品图片</label>
                    <div class="input-group" data-provides="fileinput">
                      <div class="custom-file">
                        <input type="file" class="custom-file-input product1" id="exampleInputFile" accept="image/gif,image/jpeg,image/x-png">
                        <label class="custom-file-label" for="exampleInputFile">选择图片</label>
                      </div>
                      <div class="input-group-append">
                        <!-- <span class="input-group-text" id="">Upload</span> -->
                      </div>
                      <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;">
                        <% if(product.imgs && product.imgs.length >= 1){%>
                        <img style="width: 200px;height:150px" src="<%=product.imgs[0] %>" alt="">
                        <%} %>
                      </div>

                    </div>
                  </div>
                  <div class="form-group">
                    <label for="exampleInputFile">商品图片</label>
                    <div class="input-group" data-provides="fileinput">
                      <div class="custom-file">
                        <input type="file" class="custom-file-input product2" id="exampleInputFile" accept="image/gif,image/jpeg,image/x-png">
                        <label class="custom-file-label" for="exampleInputFile">选择图片</label>
                      </div>
                      <div class="input-group-append">
                        <!-- <span class="input-group-text" id="">Upload</span> -->
                      </div>
                      <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;">
                        <% if(product.imgs && product.imgs.length >= 2){%>
                        <img style="width: 200px;height:150px" src="<%=product.imgs[1] %>" alt="">
                        <%} %>
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="exampleInputFile">商品图片</label>
                    <div class="input-group" data-provides="fileinput">
                      <div class="custom-file">
                        <input type="file" class="custom-file-input product3" id="exampleInputFile" accept="image/gif,image/jpeg,image/x-png">
                        <label class="custom-file-label" for="exampleInputFile">选择图片</label>
                      </div>
                      <div class="input-group-append">
                        <!-- <span class="input-group-text" id="">Upload</span> -->
                      </div>
                      <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;"></div>
                      <% if(product.imgs && product.imgs.length >= 3){%>
                      <img style="width: 200px;height:150px" src="<%=product.imgs[2] %>" alt="">
                      <%} %>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="exampleInputFile">商品图片</label>
                    <div class="input-group" data-provides="fileinput">
                      <div class="custom-file">
                        <input type="file" class="custom-file-input product4" id="exampleInputFile" accept="image/gif,image/jpeg,image/x-png">
                        <label class="custom-file-label" for="exampleInputFile">选择图片</label>
                      </div>
                      <div class="input-group-append">
                        <!-- <span class="input-group-text" id="">Upload</span> -->
                      </div>
                      <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;"></div>
                      <% if(product.imgs && product.imgs.length >= 4){%>
                      <img style="width: 200px;height:150px" src="<%=product.imgs[3] %>" alt="">
                      <%} %>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="exampleInputFile">商品图片</label>
                    <div class="input-group" data-provides="fileinput">
                      <div class="custom-file">
                        <input type="file" class="custom-file-input product5" id="exampleInputFile" accept="image/gif,image/jpeg,image/x-png">
                        <label class="custom-file-label" for="exampleInputFile">选择图片</label>
                      </div>
                      <div class="input-group-append">
                        <!-- <span class="input-group-text" id="">Upload</span> -->
                      </div>
                      <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;"></div>
                      <% if(product.imgs && product.imgs.length >= 5){%>
                      <img style="width: 200px;height:150px" src="<%=product.imgs[4] %>" alt="">
                      <%} %>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="exampleInputFile">商品图片</label>
                    <div class="input-group" data-provides="fileinput">
                      <div class="custom-file">
                        <input type="file" class="custom-file-input product6" id="exampleInputFile" accept="image/gif,image/jpeg,image/x-png">
                        <label class="custom-file-label" for="exampleInputFile">选择图片</label>
                      </div>
                      <div class="input-group-append">
                        <!-- <span class="input-group-text" id="">Upload</span> -->
                      </div>
                      <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;"></div>
                      <% if(product.imgs && product.imgs.length >= 6){%>
                      <img style="width: 200px;height:150px" src="<%=product.imgs[5] %>" alt="">
                      <%} %>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="exampleInputFile">商品图片</label>
                    <div class="input-group" data-provides="fileinput">
                      <div class="custom-file">
                        <input type="file" class="custom-file-input product7" id="exampleInputFile" accept="image/gif,image/jpeg,image/x-png">
                        <label class="custom-file-label" for="exampleInputFile">选择图片</label>
                      </div>
                      <div class="input-group-append">
                        <!-- <span class="input-group-text" id="">Upload</span> -->
                      </div>
                      <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;"></div>
                      <% if(product.imgs && product.imgs.length >= 7){%>
                      <img style="width: 200px;height:150px" src="<%=product.imgs[6] %>" alt="">
                      <%} %>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="exampleInputFile">商品图片</label>
                    <div class="input-group" data-provides="fileinput">
                      <div class="custom-file">
                        <input type="file" class="custom-file-input product8" id="exampleInputFile" accept="image/gif,image/jpeg,image/x-png">
                        <label class="custom-file-label" for="exampleInputFile">选择图片</label>
                      </div>
                      <div class="input-group-append">
                        <!-- <span class="input-group-text" id="">Upload</span> -->
                      </div>
                      <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;"></div>
                      <% if(product.imgs && product.imgs.length >= 8){%>
                      <img style="width: 200px;height:150px" src="<%=product.imgs[7] %>" alt="">
                      <%} %>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="exampleInputFile">商品图片</label>
                    <div class="input-group" data-provides="fileinput">
                      <div class="custom-file">
                        <input type="file" class="custom-file-input product9" id="exampleInputFile" accept="image/gif,image/jpeg,image/x-png">
                        <label class="custom-file-label" for="exampleInputFile">选择图片</label>
                      </div>
                      <div class="input-group-append">
                        <!-- <span class="input-group-text" id="">Upload</span> -->
                      </div>
                      <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;"></div>
                      <% if(product.imgs && product.imgs.length >= 9){%>
                      <img style="width: 200px;height:150px" src="<%=product.imgs[8] %>" alt="">
                      <%} %>
                    </div>
                  </div>

                </div>
                <!-- /.card-body -->

                <div class="card-footer">
                  <div type="" class="btn btn-primary">Submit</div>
                </div>
              </form>
            </div>
            <!-- /.card -->

          </div>
        </div><!-- /.container-fluid -->
      </section>
      <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->
    <footer class="main-footer">
      <!-- <strong>Copyright &copy; 2014-2018 <a href="#">AdminLTE.io</a>.</strong>
    All rights reserved.
    <div class="float-right d-none d-sm-inline-block">
      <b>Version</b> 3.0.0-alpha
    </div> -->
    </footer>

    <!-- Control Sidebar -->
    <aside class="control-sidebar control-sidebar-dark">
      <!-- Control sidebar content goes here -->
    </aside>
    <!-- /.control-sidebar -->
  </div>
  <!-- ./wrapper -->

  <!-- jQuery -->
  <script src="/management/plugins/jquery/jquery.min.js"></script>
  <!-- jQuery UI 1.11.4 -->
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
  <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
  <script>
    $.widget.bridge('uibutton', $.ui.button)
  </script>
  <!-- Bootstrap 4 -->
  <script src="/management/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
  <!-- Morris.js charts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
  <script src="/management/plugins/morris/morris.min.js"></script>
  <!-- Sparkline -->
  <script src="/management/plugins/sparkline/jquery.sparkline.min.js"></script>
  <!-- jvectormap -->
  <script src="/management/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
  <script src="/management/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
  <!-- jQuery Knob Chart -->
  <script src="/management/plugins/knob/jquery.knob.js"></script>
  <!-- daterangepicker -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.2/moment.min.js"></script>
  <script src="/management/plugins/daterangepicker/daterangepicker.js"></script>
  <!-- datepicker -->
  <script src="/management/plugins/datepicker/bootstrap-datepicker.js"></script>
  <!-- Bootstrap WYSIHTML5 -->
  <script src="/management/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js"></script>
  <!-- Slimscroll -->
  <script src="/management/plugins/slimScroll/jquery.slimscroll.min.js"></script>
  <!-- FastClick -->
  <script src="/management/plugins/fastclick/fastclick.js"></script>
  <!-- AdminLTE App -->
  <script src="/management/js/adminlte.js"></script>
  <script src="/management/plugins/ckeditor/ckeditor.js"></script>
  <!-- AdminLTE dashboard demo (This is only for demo purposes) -->
  <!-- <script src="/management/js/pages/dashboard.js"></script> -->
  <!-- AdminLTE for demo purposes -->
  <script src="/management/js/demo.js"></script>
  <script src="/js/bootstrap-fileinput.js"></script>
  <script>
    $(function () {

      $('.addPartsDom').click(function (E) {
        var partsDom = $('.partsDom').clone();
        partsDom.find('.addPartsDom').remove();
        $($('.partsDom')[0]).after($(partsDom[0]));
        $('.deleteParts').unbind('click');
        $('.deleteParts').click(function (e) {
          if ($('.partsDom').length == 1) {
            alert('必须添加一个')
          }
          else {
            this.parentElement.remove()
          }
        })
      })

      $('.addPropertyDom').click((function (e) {
        var properyDom = $('.propertyDom').clone();
        properyDom.find('.addPropertyDom').remove();
        $($('.propertyDom')[0]).after($(properyDom[0]))
        $('.deletePropertyDom').unbind('click');
        $('.deletePropertyDom').click(function (e) {
          if ($('.propertyDom').length == 1) {
            alert('必须添加一个')
          }
          else {
            this.parentElement.parentElement.remove();
          }
        })
      }))

      $('.deleteParts').click(function (e) {
        // this.parentElement.remove();
        if ($('.partsDom').length == 1) {
          alert('必须添加一个')
        }
        else {
          this.parentElement.parentElement.remove();
        }
        // this.parentElement.parentElement.remove();
      })

      $('.search').on('change', function (value) {
        var that = this;
        // debugger
        $.ajax({
          url: '/api/searchPartsApi?pName=' + that.value,
          type: 'GET',
          async: false,
          cache: false,
          success: function (data) {
            console.log(data);
            if (data.status && data.status === 'success') {
              $(that.parentElement).find('select').html(data.data)
              // debugger;
              // location.href = '/management/productMgrM'
            } else if (data.msg) {
              alert(data.msg)
              // console.log(data.message);
            }
          },
          error: function (data) {
            console.log(data.status);
          }
        });
      });

      $('.deletePropertyDom').click(function (e) {
        if ($('.propertyDom').length == 1) {
          alert('必须添加一个')
        }
        else {
          this.parentElement.parentElement.remove();
        }
        // this.parentElement.parentElement.remove();
      })
      // $('.parts').change(function (e) {
      //   // debugger
      //   let parts = $('.parts');
      //   let hasOne = false;
      //   for (let j = 0; j < parts.length; j++) {
      //     if(parts[j].value == '请选择'){
      //       hasOne = true;
      //     }
      //   }

      //   if(!hasOne){

      //   }
      // })
      // Replace the <textarea id="editor1"> with a CKEditor
      // instance, using default configuration.
      var descriptionEditor = null;
      var structureEditor = null;
      var configureEditor = null;
      var helpEditor = null;
      var pid = 'pid_' + new Date().getTime();
      var cpid = $('input.pid').val();
      ClassicEditor
        .create(document.querySelector('#description'), {
          ckfinder: {
            uploadUrl: '/api/uploadImages?command=description&pid=' + cpid && cpid.trim() != '' ? cpid : pid + '&type=Files&responseType=json'
          }
        })
        .then(function (editor) {
          descriptionEditor = editor;
          // The editor instance
        })
        .catch(function (error) {
          console.error(error)
        });

      ClassicEditor
        .create(document.querySelector('#structure'), {
          ckfinder: {
            uploadUrl: '/api/uploadImages?command=structure&pid=' + cpid && cpid.trim() != '' ? cpid : pid + '&type=Files&responseType=json'
          }
        })
        .then(function (editor) {
          structureEditor = editor;
          // The editor instance
        })
        .catch(function (error) {
          console.error(error)
        })

      ClassicEditor
        .create(document.querySelector('#configure'), {
          ckfinder: {
            uploadUrl: '/api/uploadImages?command=configure&pid=' + cpid && cpid.trim() != '' ? cpid : pid + '&type=Files&responseType=json'
          }
        })
        .then(function (editor) {
          configureEditor = editor;
          // The editor instance
        })
        .catch(function (error) {
          console.error(error)
        })

      ClassicEditor
        .create(document.querySelector('#help'), {
          ckfinder: {
            uploadUrl: '/api/uploadImages?command=help&pid=' + cpid && cpid.trim() != '' ? cpid : pid + '&type=Files&responseType=json'
          }
        })
        .then(function (editor) {
          helpEditor = editor;
          // The editor instance
        })
        .catch(function (error) {
          console.error(error)
        })

      $('.btn.btn-primary').click(function (e) {
        // e.preventDefault();
        // debugger
        var data = new FormData();
        var description = descriptionEditor.getData();
        data.append("description", description);
        var structure = structureEditor.getData();
        data.append("structure", structure);
        var configure = configureEditor.getData();
        data.append("configure", configure);
        var help = helpEditor.getData();
        data.append("help", help);
        var title = $('input.title').val();
        data.append("title", title);
        var productDesc = $('input.productDesc').val();
        data.append("productDesc", productDesc);
        var produtType = $('input.produtType').val();
        data.append("produtType", produtType);
        // var identifier = $('input.identifier').val();
        // data.append("identifier", identifier);
        
        // var selectionAddress = $('input.selectionAddress').val();
        // data.append("selectionAddress", selectionAddress);
        // var applicationAddress = $('input.applicationAddress').val();
        // data.append("applicationAddress", applicationAddress);
        // var installAddress = $('input.installAddress').val();
        // data.append("installAddress", installAddress);
        
        var productSEO = $('input.productSEO').val();
        data.append("productSEO", productSEO);
        var weight = $('input.weight').val();
        data.append("weight", weight);
        var promotion = $('input.promotion').val();
        data.append("promotion", promotion);
        var onSale = 1;
        let storeId = -1;
        let storeName = '';
        if (jQuery(".onSale  option:selected").text() == '是') {
          onSale = 1;
        }
        else {
          onSale = 0;
        }
        data.append("onSale", onSale);
        if (jQuery(".category  option:selected").attr('data-target')) {
          storeId = parseInt(jQuery(".category  option:selected").attr('data-target'));
          storeName = jQuery(".category  option:selected").text();
          data.append("storeId", storeId);
          data.append("storeName", storeName);
        }

        var partsDom = $('.parts');
        let parids = [];
        for (let t = 0; t < partsDom.length; t++) {
          // $(partsDom[0]).find('option:selected').text()
          if ($(partsDom[t]).find('option:selected').attr('data-target')) {
            parids.push($(partsDom[t]).find('option:selected').attr('data-target'))
          }
        }
        data.append("parids", parids);

        var propertyDom = $('.propertyDom');
        let propertys = [];
        for (let k = 0; k < propertyDom.length; k++) {
          let property = $(propertyDom[k]).find('input');
          if (property && property.length >= 5) {
            propertys.push(property[0].value + '-' + property[1].value + '-' + property[2].value + '-' + property[3].value + '-' + property[4].value)
          }
        }
        data.append('propertys', propertys)

        for(var i = 1;i<=9; i++){
          if (document.getElementsByClassName('product'+i)[0].files[0]) {
            data.append("product"+i, document.getElementsByClassName('product'+i)[0].files[0])
          }
        }
        
        if (document.getElementsByClassName('selectionPdf')[0].files[0]) {
          data.append("selectionPdf", document.getElementsByClassName('selectionPdf')[0].files[0])
        }
        if (document.getElementsByClassName('applicationPdf')[0].files[0]) {
          data.append("applicationPdf", document.getElementsByClassName('applicationPdf')[0].files[0])
        }
        if (document.getElementsByClassName('installPdf')[0].files[0]) {
          data.append("installPdf", document.getElementsByClassName('installPdf')[0].files[0])
        }
        data.append('pid', cpid && cpid.trim() != '' ? cpid : pid)
        // for (var i = 0; i < ddom.length; i++) {
        //   if (ddom[i] && ddom[i].value && ddom[i].value.length > 0) {
        //     data.append(ddom[i].getAttribute('data-target'), ddom[i].value)
        //   }
        // }

        // if(jQuery(".category  option:selected"))

        $.ajax({
          url: cpid && cpid.trim() != '' ? '/api/updateProduct?pid=' + cpid : '/api/createProduct',
          type: 'POST',
          data: data,
          async: false,
          cache: false,
          contentType: false,
          processData: false,
          success: function (data) {
            console.log(data);
            if (data.status && data.status === 'success') {
              alert(data.msg)
              location.href = '/management/productMgrM'
            } else if (data.msg) {
              alert(data.msg)
              // console.log(data.message);
            }
          },
          error: function (data) {
            console.log(data.status);
          }
        });
      })
    })
  </script>
</body>

</html>